<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nx_metadata_sdk: Object Streamer Plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nx_metadata_sdk
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Metadata SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Object Streamer Plugin </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>// Copyright 2018-present Network Optix, Inc. Licensed under MPL 2.0: www.mozilla.org/MPL/2.0/ </p><hr/>
 <h2>Introduction</h2>
<p>This Plugin is intended to be used for debugging/investigating/developing purposes and can generate any needed sequence of Objects that are taken from a specific user-generated file.</p>
<p>The Taxonomy of the generated Objects (their types and Attributes) must be defined in the Device Agent manifest - a .json file specified in the Device Agent settings. An example of such manifest is provided in <code>manifest.json</code>.</p>
<p>The Object stream to be "played back" by the Plugin is taken from the .json file specified in the Device Agent settings. An example of such file is provided in <code>stream.json</code>.</p>
<p>To generate a stream and manifest files, the provided <code>generate.py</code> script can be used. </p><hr/>
 <h2>Stream file format</h2>
<p>A stream file is essentially a script which defines when and what metadata will be generated by the plugin. It is a JSON file containing an array of per-frame object entries. There are several types of entries like bounding boxes and best shots. The following fields are allowed for each entry:</p>
<ul>
<li><code>frameNumber</code> <b>[required]</b>, <b>[int]</b> Frame number the entry will be instantiated on.</li>
<li><code>typeId</code> <b>[required]</b>, <b>[string]</b> Object Type of the entry.</li>
<li><code>trackId</code> <b>[required]</b>, <b>[guid/placeholder]</b> Can be either a fixed UUID, or <code>"$"</code> or <code>"$$"</code> followed by a number, which makes a new random UUID for each such number:<ul>
<li><code>$&lt;number&gt;</code> Id of the Object Track is changed every time the Device Agent is recreated, chosen randomly.</li>
<li><code>$$&lt;number&gt;</code> Id of the Object Track is changed every stream cycle or every time the Device Agent is recreated, chosen randomly.</li>
</ul>
</li>
<li><code>attributes</code> <b>[optional]</b>, <b>[map(string, string)]</b> A string or string map of Attributes. Here the key is the Attribute name, and the value is the Attribute value.</li>
<li><code>boundingBox</code> <b>[required]</b>, <b>[object]</b> Object containing coordinates of the Object bounding box. Contains the following fields:<ul>
<li><code>x</code> Top-left corner horizontal coordinate, 0..1.</li>
<li><code>y</code> Top-left corner vertical coordinate, 0..1.</li>
<li><code>width</code> Width of the bounding box, 0..1.</li>
<li><code>height</code> Height of the bounding box, 0..1.</li>
</ul>
</li>
<li><code>imageSource</code> <b>[optional]</b>, <b>[string]</b>, <b>[applied only for best shot entries]</b> A string containing either a path to a local image or an image URL that will be used as a Best Shot.</li>
<li><code>entryType</code> <b>[optional]</b>, <b>[string]</b> Either <code>"bestShot"</code> or <code>"regular"</code>. The default is <code>"regular"</code>.</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">{</div><div class="line">        &quot;frameNumber&quot;: 0,</div><div class="line">        &quot;typeId&quot;: &quot;nx.base.Vehicle&quot;,</div><div class="line">        &quot;trackId&quot;: &quot;$$10&quot;,</div><div class="line">        &quot;attributes&quot;: {</div><div class="line">            &quot;Color&quot;: &quot;Red&quot;,</div><div class="line">            &quot;Brand&quot;: &quot;Lada&quot;,</div><div class="line">            &quot;Model&quot;: &quot;2106&quot;,</div><div class="line">            &quot;LicensePlate.Number&quot;: &quot;A001AA&quot;,</div><div class="line">            &quot;LicensePlate.State/Province&quot;: &quot;77&quot;,</div><div class="line">            &quot;LicensePlate.Country&quot;: &quot;Russia&quot;</div><div class="line">        },</div><div class="line">        &quot;boundingBox&quot;: {</div><div class="line">            &quot;x&quot;: 0.5822482733134051,</div><div class="line">            &quot;y&quot;: 0.3331168814679488,</div><div class="line">            &quot;width&quot;: 0.17938270955154084,</div><div class="line">            &quot;height&quot;: 0.15537941471920017</div><div class="line">        }</div><div class="line">    },</div><div class="line">    {</div><div class="line">        &quot;frameNumber&quot;: 0,</div><div class="line">        &quot;typeId&quot;: &quot;nx.base.Vehicle&quot;,</div><div class="line">        &quot;trackId&quot;: &quot;$$10&quot;,</div><div class="line">        &quot;attributes&quot;: {</div><div class="line">            &quot;Best Shot Type&quot;: &quot;URL&quot;,</div><div class="line">            &quot;Color&quot;: &quot;Dark Red&quot;,</div><div class="line">            &quot;Brand&quot;: &quot;Mercedes&quot;,</div><div class="line">            &quot;Model&quot;: &quot;EQE&quot;,</div><div class="line">            &quot;LicensePlate.Number&quot;: &quot;KEN560&quot;,</div><div class="line">            &quot;LicensePlate.State/Province&quot;: &quot;05&quot;,</div><div class="line">            &quot;LicensePlate.Country&quot;: &quot;Kazakhstan&quot;</div><div class="line">        },</div><div class="line">        &quot;boundingBox&quot;: {</div><div class="line">            &quot;x&quot;: 0.5822482733134051,</div><div class="line">            &quot;y&quot;: 0.3331168814679488,</div><div class="line">            &quot;width&quot;: 0.17938270955154084,</div><div class="line">            &quot;height&quot;: 0.15537941471920017</div><div class="line">        },</div><div class="line">        &quot;imageSource&quot;: &quot;https://example.com/photos/200/300&quot;,</div><div class="line">        &quot;entryType&quot;: &quot;bestShot&quot;</div><div class="line">    }</div></div><!-- fragment --> <hr/>
 <h2>Stream generation script</h2>
<p>The script <code>generate.py</code> can generate <code>stream.json</code> and <code>manifest.json</code> based on <code>config.json</code>. The example of <code>config.json</code> file is provided.</p>
<h3>Command line options</h3>
<ul>
<li><code>--config, -c</code> <b>[required]</b> Path to the configuration file containing parameters of the stream to be generated.</li>
<li><code>--manifest-file, -m</code> <b>[optional]</b> Path to the output Device Agent Manifest file, default is <code>manifest.json</code>.</li>
<li><code>--stream-file, -s</code> <b>[optional]</b> Path to the output stream file, default is <code>stream.json</code>.</li>
<li><code>--compressed-stream</code> <b>[optional]</b> Removes all formatting from the output stream file.</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">generate.py --config config.json --manifest-file my_manifest.json --stream-file my_stream.json</div><div class="line">--compressed-stream</div></div><!-- fragment --><h3>Configuration file format</h3>
<p>The configuration file is a simple JSON file with a JSON object at the top level. The following settings are available:</p>
<ul>
<li><code>objectCount</code> - <b>[int]</b> Count of objects that simultaneously exist on each frame. Default is <code>5</code>.</li>
<li><code>streamDurationInFrames</code> - <b>[int]</b> Duration in frames of a single stream cycle. Default is <code>300</code>.</li>
<li><code>typeLibrary</code> - <b>[object]</b> The Type Library section of the generated Device Agent manifest. Object Types auto-generated from the <code>objectTemplates</code> section can be added to the <code>typeLibrary</code> of the output manifest as well. See <code>manifests.md</code> in the SDK for more information about Type Library and Device Agent Manifest.</li>
<li><code>objectTemplates</code> - <b>[array]</b> Settings of the Object Track generator, as an array of JSON objects each representing a template for the particular Object type. The set of fields of each template depends on the generator type which is defined by the <code>movementPolicy</code> field of the template. The default and the only currently available value of <code>movementPolicy</code> is <code>random</code>. The structure of a template JSON object is given below.</li>
</ul>
<h4><code>random</code> Object template settings</h4>
<p>All fields are optional.</p>
<ul>
<li><code>objectTypeId</code> - <b>[string]</b> Object Type id of the generated Object Track. If not defined, the id is auto-generated. If the id is not represented in the <code>typeLibrary</code> section, the name of the type is auto-generated from the id, and the corresponding Object Type is added to the output Device Agent manifest.</li>
<li><code>trackIdPolicy</code> - <b>[string]</b> The policy of Object Track id behavior. Three options are available:<ul>
<li><code>fixed</code> - Object track id never changes (neither between Device Agent instantiations nor between stream cycles).</li>
<li><code>changeOncePerStreamCycle</code> - Object Track id is changed every stream cycle.</li>
<li><code>changeOnDeviceAgentCreation</code> - Object Track id is changed every time the Device Agent is instantiated.</li>
</ul>
</li>
<li><code>minWidth</code> - <b>[float(0.0, 1.0]]</b> Minimum width of the Object bounding box. Default is <code>0.05</code>.</li>
<li><code>maxWidth</code> - <b>[float(0.0, 1.0]]</b> Maximum width of the Object bounding box. Default is <code>0.3</code>.</li>
<li><code>minHeight</code> - <b>[float(0.0, 1.0]]</b> Minimum height of the Object bounding box. Default is <code>0.05</code>.</li>
<li><code>maxHeight</code> - <b>[float(0.0, 1.0]]</b> Maximum height of the Object bounding box. Default is <code>0.3</code>.</li>
<li><code>attributes</code> - <b>[object]</b> Key-value pairs, the key is an Object attribute name, the value is an Object Attribute value. All values must be represented as strings. This set of Attributes is assigned to each Object generated from the template.</li>
<li><code>bestShots</code> - <b>[array]</b> A list of Best Shot settings for the particular Object template. Each Best Shot item can contain the following fields:<ul>
<li><code>frameNumber</code> - <b>[int, required]</b> The frame number the Best Shot has to be generated on.</li>
<li><code>imageSource</code> - <b>[string]</b> Can contain an HTTP or HTTPS URL or a path to an image. If empty, the current bounding box of the Object is used as its Best Shot.</li>
<li><code>attributes</code> - <b>[object]</b> Attributes of the Best Shot. The same as Attributes for an Object template.</li>
</ul>
</li>
</ul>
<h4>Example</h4>
<div class="fragment"><div class="line">{</div><div class="line">    &quot;objectCount&quot;: 5,</div><div class="line">    &quot;streamDurationInFrames&quot;: 100,</div><div class="line">    &quot;typeLibrary&quot;:</div><div class="line">    {</div><div class="line">        &quot;objectTypes&quot;:</div><div class="line">        [</div><div class="line">            {</div><div class="line">                &quot;id&quot;: &quot;stub.objectStreamer.custom.type.1&quot;,</div><div class="line">                &quot;name&quot;: &quot;Stub OS: Custom Type 1&quot;</div><div class="line">            }</div><div class="line">        ]</div><div class="line">    },</div><div class="line">    &quot;objectTemplates&quot;:</div><div class="line">    [</div><div class="line">        {</div><div class="line">            &quot;objectTypeId&quot;: &quot;nx.base.Vehicle&quot;,</div><div class="line">            &quot;movementPolicy&quot;: &quot;random&quot;,</div><div class="line">            &quot;trackIdPolicy&quot;: &quot;changeOncePerStreamCycle&quot;,</div><div class="line">            &quot;minWidth&quot;: 0.1,</div><div class="line">            &quot;minHeight&quot;: 0.1,</div><div class="line">            &quot;maxWidth&quot;: 0.3,</div><div class="line">            &quot;maxHeight&quot;: 0.3,</div><div class="line">            &quot;attributes&quot;:</div><div class="line">            {</div><div class="line">                &quot;Color&quot;: &quot;Red&quot;,</div><div class="line">                &quot;Brand&quot;: &quot;Ford&quot;,</div><div class="line">                &quot;Model&quot;: &quot;F150&quot;,</div><div class="line">                &quot;LicensePlate.Number&quot;: &quot;LHD 8448&quot;,</div><div class="line">                &quot;LicensePlate.State/Province&quot;: &quot;Texas&quot;,</div><div class="line">                &quot;LicensePlate.Country&quot;: &quot;USA&quot;</div><div class="line">            },</div><div class="line">            &quot;bestShots&quot;: [</div><div class="line">                {</div><div class="line">                    &quot;imageSource&quot;: &quot;https://picsum.photos/200/300&quot;,</div><div class="line">                    &quot;frameNumber&quot;: 10,</div><div class="line">                    &quot;attributes&quot;: {</div><div class="line">                        &quot;some attribute&quot;: &quot;attribute value&quot;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">            ]</div><div class="line">        },</div><div class="line">        {</div><div class="line">            &quot;objectTypeId&quot;: &quot;stub.objectStreamer.custom.type.1&quot;,</div><div class="line">            &quot;movementPolicy&quot;: &quot;random&quot;,</div><div class="line">            &quot;attributes&quot;:</div><div class="line">            {</div><div class="line">                &quot;string attribute 1&quot;: &quot;first string attribute&quot;,</div><div class="line">                &quot;string attribute 2&quot;: &quot;second string attribute&quot;,</div><div class="line">                &quot;number attribute 1&quot;: &quot;0.1&quot;,</div><div class="line">                &quot;number attribute 2&quot;: &quot;300&quot;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    ]</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
